# PC Language - Fast CTF Verification (No External Calls)
# Tests only built-in functions that don't call external processes

print("=" * 60)
print("PC Language - Fast CTF Verification")
print("=" * 60)
print("")

passed = 0
failed = 0
total = 0

# ============================================================================
# 1. CRYPTO
# ============================================================================
print("[1] CRYPTO - Cryptography")
print("-" * 60)

# MD5
total = total + 1
if md5("test") == "098f6bcd4621d373cade4e832627b4f6":
    print("  âœ“ MD5 hash")
    passed = passed + 1
else:
    print("  âœ— MD5 hash")
    failed = failed + 1

# SHA256
total = total + 1
if sha256("hello") == "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824":
    print("  âœ“ SHA256 hash")
    passed = passed + 1
else:
    print("  âœ— SHA256 hash")
    failed = failed + 1

# Base64
total = total + 1
b64 = base64_encode("CTF")
if base64_decode(b64) == "CTF":
    print("  âœ“ Base64 encode/decode")
    passed = passed + 1
else:
    print("  âœ— Base64 encode/decode")
    failed = failed + 1

# Hex
total = total + 1
hex_enc = hex_encode("ABC")
if hex_decode(hex_enc) == "ABC":
    print("  âœ“ Hex encode/decode")
    passed = passed + 1
else:
    print("  âœ— Hex encode/decode")
    failed = failed + 1

# XOR
total = total + 1
xor_result = xor_bytes("hello", "key")
if len(xor_result) == 5:
    print("  âœ“ XOR cipher")
    passed = passed + 1
else:
    print("  âœ— XOR cipher")
    failed = failed + 1

# ROT13
total = total + 1
rot_result = rot13("hello")
if len(rot_result) > 0:
    print("  âœ“ ROT13")
    passed = passed + 1
else:
    print("  âœ— ROT13")
    failed = failed + 1

print("")

# ============================================================================
# 2. PWN
# ============================================================================
print("[2] PWN - Binary Exploitation")
print("-" * 60)

# p32/unpack32
total = total + 1
addr32 = 0xdeadbeef
packed32 = p32(addr32)
if unpack32(packed32) == addr32:
    print("  âœ“ p32/unpack32")
    passed = passed + 1
else:
    print("  âœ— p32/unpack32")
    failed = failed + 1

# p64/unpack64
total = total + 1
addr64 = 0x7ffff7a0d000
packed64 = p64(addr64)
if unpack64(packed64) == addr64:
    print("  âœ“ p64/unpack64")
    passed = passed + 1
else:
    print("  âœ— p64/unpack64")
    failed = failed + 1

# Shellcode NOP
total = total + 1
nop_sled = shellcode_nop(10)
if len(nop_sled) == 20:
    print("  âœ“ Shellcode NOP sled")
    passed = passed + 1
else:
    print("  âœ— Shellcode NOP sled")
    failed = failed + 1

# Shellcode int 0x80
total = total + 1
int80 = shellcode_int80()
if len(int80) > 0:
    print("  âœ“ Shellcode int 0x80")
    passed = passed + 1
else:
    print("  âœ— Shellcode int 0x80")
    failed = failed + 1

print("")

# ============================================================================
# 3. REVERSE
# ============================================================================
print("[3] REVERSE - Reverse Engineering")
print("-" * 60)

# chr/ord
total = total + 1
if ord(chr(65)) == 65:
    print("  âœ“ chr/ord conversion")
    passed = passed + 1
else:
    print("  âœ— chr/ord conversion")
    failed = failed + 1

# ELF parsing
total = total + 1
elf_data = parse_elf("/bin/ls")
if elf_data != None:
    print("  âœ“ ELF parsing")
    passed = passed + 1
else:
    print("  âœ— ELF parsing")
    failed = failed + 1

# String extraction
total = total + 1
strings_list = elf_strings("/bin/ls", 10)
if len(strings_list) > 0:
    print("  âœ“ String extraction")
    passed = passed + 1
else:
    print("  âœ— String extraction")
    failed = failed + 1

# File info
total = total + 1
info = file_info("/bin/ls")
if len(info) > 0:
    print("  âœ“ File info detection")
    passed = passed + 1
else:
    print("  âœ— File info detection")
    failed = failed + 1

print("")

# ============================================================================
# 4. WEB
# ============================================================================
print("[4] WEB - Web Exploitation")
print("-" * 60)

# URL encoding
total = total + 1
url_enc = url_encode("hello world")
if url_decode(url_enc) == "hello world":
    print("  âœ“ URL encode/decode")
    passed = passed + 1
else:
    print("  âœ— URL encode/decode")
    failed = failed + 1

# SQL injection payload
total = total + 1
sqli = sqli_union(3, "users", "password")
if len(sqli) > 0:
    print("  âœ“ SQL injection payload")
    passed = passed + 1
else:
    print("  âœ— SQL injection payload")
    failed = failed + 1

# XSS payload
total = total + 1
xss = xss_payload_img("http://evil.com")
if len(xss) > 0:
    print("  âœ“ XSS payload generation")
    passed = passed + 1
else:
    print("  âœ— XSS payload generation")
    failed = failed + 1

# LFI payload
total = total + 1
lfi = lfi_payload("/etc/passwd", 5)
if len(lfi) > 0:
    print("  âœ“ LFI payload generation")
    passed = passed + 1
else:
    print("  âœ— LFI payload generation")
    failed = failed + 1

print("")

# ============================================================================
# 5. MISC
# ============================================================================
print("[5] MISC - Miscellaneous")
print("-" * 60)

# String split/join
total = total + 1
parts = split("a,b,c", ",")
joined = join(parts, ",")
if joined == "a,b,c":
    print("  âœ“ String split/join")
    passed = passed + 1
else:
    print("  âœ— String split/join")
    failed = failed + 1

# String replace
total = total + 1
replaced = replace("hello world", "world", "CTF")
if replaced == "hello CTF":
    print("  âœ“ String replace")
    passed = passed + 1
else:
    print("  âœ— String replace")
    failed = failed + 1

# Binary conversion
total = total + 1
if bin(42) == "0b101010":
    print("  âœ“ Binary conversion")
    passed = passed + 1
else:
    print("  âœ— Binary conversion")
    failed = failed + 1

# Hex conversion
total = total + 1
if hex(255) == "0xff":
    print("  âœ“ Hex conversion")
    passed = passed + 1
else:
    print("  âœ— Hex conversion")
    failed = failed + 1

# String multiplication (new feature!)
total = total + 1
repeated = "=" * 10
if len(repeated) == 10:
    print("  âœ“ String multiplication")
    passed = passed + 1
else:
    print("  âœ— String multiplication")
    failed = failed + 1

print("")

# ============================================================================
# 6. FORENSICS
# ============================================================================
print("[6] FORENSICS - Digital Forensics")
print("-" * 60)

# File type detection
total = total + 1
ftype = detect_filetype("/bin/ls")
if len(ftype) > 0:
    print("  âœ“ File type detection")
    passed = passed + 1
else:
    print("  âœ— File type detection")
    failed = failed + 1

# Hex dump
total = total + 1
hexdump = hex_dump("TEST", 0, 4)
if len(hexdump) > 0:
    print("  âœ“ Hex dump")
    passed = passed + 1
else:
    print("  âœ— Hex dump")
    failed = failed + 1

print("")

# ============================================================================
# 7. ATTACK-DEFENSE
# ============================================================================
print("[7] ATTACK-DEFENSE - Attack & Defense")
print("-" * 60)

# Ping (may be slow, but should work)
total = total + 1
if ping("127.0.0.1", 1):
    print("  âœ“ Ping connectivity")
    passed = passed + 1
else:
    print("  âœ— Ping connectivity")
    failed = failed + 1

# Service detection
total = total + 1
service = detect_service("localhost", 22)
if service == "SSH":
    print("  âœ“ Service detection")
    passed = passed + 1
else:
    print("  âœ— Service detection")
    failed = failed + 1

# IP block command
total = total + 1
block_cmd = block_ip("192.168.1.100")
if len(block_cmd) > 0:
    print("  âœ“ IP block command generation")
    passed = passed + 1
else:
    print("  âœ— IP block command generation")
    failed = failed + 1

# TCP SYN packet craft
total = total + 1
tcp_syn = craft_tcp_syn("192.168.1.1", 80)
if tcp_syn != None:
    print("  âœ“ TCP SYN packet crafting")
    passed = passed + 1
else:
    print("  âœ— TCP SYN packet crafting")
    failed = failed + 1

print("")

# ============================================================================
# RESULTS
# ============================================================================
print("=" * 60)
print("FINAL RESULTS")
print("=" * 60)
print("")
print("Total Tests:", total)
print("Passed:", passed)
print("Failed:", failed)
print("")

rate = (passed * 100) / total
print("Pass Rate:", rate, "%")
print("")

if failed == 0:
    print("ğŸ‰ ALL TESTS PASSED!")
    print("")
    print("âœ“ PC Language is FULLY FUNCTIONAL for CTF!")
    print("")
    print("Verified Categories:")
    print("  âœ“ Crypto (6 tests) - Hash, encoding, XOR, ROT13")
    print("  âœ“ Pwn (4 tests) - Binary exploitation, packing, shellcode")
    print("  âœ“ Reverse (4 tests) - ELF parsing, string extraction, chr/ord")
    print("  âœ“ Web (4 tests) - URL encoding, SQL/XSS/LFI payloads")
    print("  âœ“ Misc (5 tests) - String ops, conversions, multiplication")
    print("  âœ“ Forensics (2 tests) - File analysis, hex dump")
    print("  âœ“ Attack-Defense (4 tests) - Network recon, defense tools")
else:
    print("âš ï¸  SOME TESTS FAILED")
    print("Failed tests need investigation")

print("")
print("=" * 60)
