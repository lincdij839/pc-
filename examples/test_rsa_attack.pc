# RSA Public Key Attack Test

print("=== RSA Attack Demo ===")

# Test 1: Parse RSA public key
print("\n[1] Parsing RSA public key...")
pem = "-----BEGIN PUBLIC KEY-----
MIICIDANBgkqhkiG9w0BAQEFAAOCAg0AMIICCAKCAQAma/gXML+bivU20mJu55PZ
SjNAE6S0PQ2WV5sYIA7ZLbJ6lshW8cfohErN0TUIv+6O+hXSMFd4wrv27+f6akPE
qeNL6LWjKqcnC9I03vbyYDZuLkfeoPwM9UHIuRUfU/l/LDOCkjkOkHN5SMufg66y
OGc4wLDi9f8sET4QMerAVF/HZ7acpYYCu8QoWnOSy9KiVzKQMzKkaL+WcN2sbLsA
61zjixv7ybMHDmcyMKHb5VbfPsqMW19roYLV5luY3SlrhTogmyGg19Q3k7hYW3ca
Jc7WLEbPD/OnlHMDLArNUYMyB9t0CdLNZZCHE6pbiMaNGS+rwGcqxHbWCpGCS0vZ
AoIBAA0zxRVob0N2SXRSPv7GRHMzj/mpACiz3VrKtwKgm+MM1UrnvbtCpPcqjqw6
4w7HJqf6O/ccA7l0qY35jbvhOLD2II6rf8USZwkm27ygOuHA3SRS9XZyzpshUmRO
YyJtogGntK4R9R7wfW1HHJbIj5R3/HV/gYdT9XxKq7yICxFSVv3u1lgVBjNeUzTn
5MzOlX9tCEjcS54eq9OCGLEIetj24xTfsruKf/DDGNTRA1et8fU4H49NMsqqHL1R
ZdKvy1SEBWoOrj/XQycz0Dsyre0jcaDWnaywlulHGrPKXYc6ePAJ9S7IMOTKblCf
FU9nj28KAsm/RBAV3PEMkJ3edPM=
-----END PUBLIC KEY-----"

key_info = rsa_parse_pem(pem)
print("Modulus n (hex):")
print(key_info)

# Test 2: Small RSA factorization
print("\n[2] Testing small RSA factorization...")
small_n = 143
result = rsa_factor_small(small_n)
print("n = 143")
print(result)

# Test 3: Hash functions
print("\n[3] Testing hash functions...")
data = "hello"
print("MD5:")
print(md5(data))
print("SHA256:")
print(sha256(data))

# Test 4: XOR
print("\n[4] Testing XOR cipher...")
plain = "secret"
key = "abc"
enc = xor_bytes(plain, key)
print("Encrypted (hex):")
print(hex_encode(enc))
dec = xor_bytes(enc, key)
print("Decrypted:")
print(dec)

# Test 5: Base64
print("\n[5] Testing Base64...")
original = "CTF{test}"
encoded = base64_encode(original)
print("Encoded:")
print(encoded)
decoded = base64_decode(encoded)
print("Decoded:")
print(decoded)

print("\n=== All tests completed ===")
